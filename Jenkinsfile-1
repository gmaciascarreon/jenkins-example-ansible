pipeline {
  agent any

  stages {
    stage('Hello') {
      steps {
        sh '''
          #uname -a
          #sudo dnf install -y epel-release
          #sudo dnf install -y https://github.com/apptainer/apptainer/releases/download/v1.4.4/apptainer-1.4.4-1.x86_64.rpm
          #sudo yum install -y apptainer python3
          sudo subscription-manager repos --enable codeready-builder-for-rhel-9-$(arch)-rpms
          sudo dnf install https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm -y
          sudo dnf install https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm -y
          sudo dnf install -y apptainer

          sudo yum install -y python3
          python3 -m venv ansible
          source ansible/bin/activate
          pip install --upgrade pip
          pip install ansible
          ansible --version
          ansible-playbook --version
          ansible-galaxy --version
        '''
      }
    }
  }
}
